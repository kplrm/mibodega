<div class="col-lg-5 col-md-5 col-sm-3 align-self-center text-right">
    {% if id_bodega_text == "Cercanas" %}Seleccione su bodega{% else %}{{ id_bodega_text }}{% endif %}
</div>
<!-- Geolocation -->
<input type="text" id="Latitude" disabled>
<input type="text" id="Longitude" disabled>
<script>
    function showLocation(position) {
        document.getElementById("Latitude").value = position.coords.latitude;
        document.getElementById("Longitude").value = longitude = position.coords.longitude;
        alert("Latitude : " + document.getElementById("Latitude").value + " Longitude: " + document.getElementById("Longitude").value);
    }

    function errorHandler(err) {
        if(err.code == 1) {
        alert("Error: Access is denied!");
        } else if( err.code == 2) {
        alert("Error: Position is unavailable!");
        }
    }
        
    function getLocation() {
        if(navigator.geolocation) {
        // timeout at 60000 milliseconds (60 seconds)
        var options = {timeout:60000};
        navigator.geolocation.getCurrentPosition(showLocation, errorHandler, options);
        } else {
        alert("Sorry, browser does not support geolocation!");
        }
    }
</script>

<div class="col-lg-2 col-md-1 col-sm-1 align-self-center">
    <ul class="nav-right">
        <li class="heart-icon">
            <a href="#">
                <i class="icon_pin_alt" id="select_shop_2" data-toggle="modal" data-target="#exampleModalCenter" onclick="getLocation()"></i>
            </a>
        </li>
    </ul>
</div>
<!-- end Geolocation -->
<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle"></h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body text-left">
            {% include 'main/includes/select_shop.html' %}
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-light" id="anular-seleccion">Seleccionar todas las bodegas cercanas</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-primary" id="modal-save">Guardar</button>
        </div>
    </div>
    </div>
</div>
<script>
    $(document).ready(function(){
        $("#exampleModalCenter").on('shown.bs.modal', function () {
            setTimeout(function() {
                map.invalidateSize();
            }, 10);
        });
        $("#anular-seleccion").click(function(){
            $('#bodega_name').val('Cercanas');
            $('#bodega_id').val('Cercanas');
        });
        $("#modal-save").click(function(){
            $("#exampleModalCenter").modal("hide");
            $('.modal-backdrop').hide();
            $.ajax({
                headers: {'X-CSRFToken': '{{ csrf_token }}'},
                url: "/save_store_location",
                type: "POST",
                dataType: "json",
                data:   {
                            'bodega_name': $('#bodega_name').val(),
                            'id_bodega': $('#bodega_id').val()
                        },
                success: function(response){
                    alert ("resp: "+response);
                }
            });
            $.ajax({
                url: "/embutidos",
                type: "GET",
                success: function(){
                    location.reload();
                }
            });
        });
    });
</script>