
        <h3>Seleccione su bodega</h3>
        <p><br></p>
        <label for="bodega_name">Bodega:</label>
        <input type="text" class="form-control" id="bodega_name" value="Cercanas" disabled>
        <p><br></p>
        <input type="hidden" class="form-control" id="bodega_id" value="Cercanas" disabled> <!--change to type hidden to hide-->
            
        <div id="mapid"></div>
        <script type = "text/javascript">
            function showLocation(position) {
                var latitude = position.coords.latitude;
                var longitude = position.coords.longitude;
                alert("Latitude : " + latitude + " Longitude: " + longitude);
            }

            function errorHandler(err) {
                if(err.code == 1) {
                alert("Error: Access is denied!");
                } else if( err.code == 2) {
                alert("Error: Position is unavailable!");
                }
            }
                
            function getLocation() {
                if(navigator.geolocation) {
                // timeout at 60000 milliseconds (60 seconds)
                var options = {timeout:60000};
                navigator.geolocation.getCurrentPosition(showLocation, errorHandler, options);
                } else {
                alert("Sorry, browser does not support geolocation!");
                }
            }


            if (latitude != null) and (longitude != null) {
                var map = L.map('mapid').setView([ latitude, longitude ], 14);
            } else {
                var map = L.map('mapid').setView([ -12.046374, -77.0427934 ], 14);
            }
                
        
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
        
            const customMarkerIcon = L.AwesomeMarkers.icon({
                "extraClasses": "fa-rotate-0", 
                "icon": "shopping-cart", 
                "iconColor": "white", 
                "markerColor": "orange", 
                "prefix": "glyphicon"
            });	
            
            {% for shop in shops %}
            var marker = L.marker([{{ shop.bd_geolocation.y }},{{ shop.bd_geolocation.x }}], {
                icon: customMarkerIcon
            }).addTo(map)
                .bindPopup( "{{ shop.bd_name }}" )
                .closePopup()
                .on('click', function onClick(shop) {
                    document.getElementById("bodega_name").value = "{{ shop.bd_name }}";
                    document.getElementById("bodega_id").value = "{{ shop.bd_ID }}";
                });
            {% endfor %}
        </script>